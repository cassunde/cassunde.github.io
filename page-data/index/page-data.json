{"componentChunkName":"component---src-pages-index-js","path":"/","result":{"data":{"site":{"meta":{"title":"Cassunde","description":"Cassunde profile and Blog","url":"https://cassunde.github.io","author":"cassunde","twitter":"@MattheusCassund","adsense":""}},"remark":{"posts":[{"post":{"html":"<h2>Configurando Health Check no Quarkus e Spring Boot</h2>\n<p>Hoje estou anotando aqui como posso fazer para configurar o endpoint de <a href=\"https://microservices.io/patterns/observability/health-check-api.html\">Health Check</a> usando o Spring-boot e o Quarkus.</p>\n<!--more-->\n<h2>O Health Check API</h2>\n<p>Quando trabalhamos com microservices muitas vezes publicamos nossas aplicações dentro de containers docker que por sua vez são publicados em orquestradores, para facilitar nossa vida, sempre que uma aplicação não estiver saudável podemos configurar que esses orquestradores possam tomar alguma ação, que na maioria das vezes será reiniciar o container x vezes até dele ficar saudável.</p>\n<p>Um benefício e que sua aplicação poderá ser testada periodicamente, dessa forma mitigando o problema de ser pego de surpresa com uma aplicação off.</p>\n<h2>Health Check no Spring Boot</h2>\n<p>Para usarmos o Health Check API no spring, precisamos importar uma lib chamada <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html\">Spring Boot Actuator</a>.</p>\n<p>Quais features podemos encontrar nessa lib:</p>\n<ol>\n<li>Auditoria</li>\n<li>Health</li>\n<li>Métricas</li>\n</ol>\n<p>Podemos também escolher em usar essas features via HTTP ou JMX.</p>\n<p><strong>Health</strong></p>\n<p>Essa informação será exposta no endpoint <code class=\"language-text\">/health</code> da sua aplicação, para habilitarmos precisamos configurar basicamente duas chaves no seu <code class=\"language-text\">application.properties</code> </p>\n<ol>\n<li>management.endpoint.health.show-details</li>\n<li>management.endpoint.health.show-components</li>\n</ol>\n<p>Essas chaves podem receber os seguintes valores:</p>\n<table>\n<thead>\n<tr>\n<th>Valor</th>\n<th>Descrição</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>never</td>\n<td>Nunca expor informação</td>\n</tr>\n<tr>\n<td>when-authorized</td>\n<td>Quando restringimos o acesso para alguns usuários</td>\n</tr>\n<tr>\n<td>always</td>\n<td>Exibe informações para todos os usuários</td>\n</tr>\n</tbody>\n</table>\n<p>Valor default e <code class=\"language-text\">never</code></p>\n<p>Resumindo a configuração básica ficaria assim:</p>\n<ul>\n<li>pom.xml</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependencies</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.boot<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-boot-starter-actuator<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependencies</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>Gradle</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">dependencies {\n    implementation &quot;org.springframework.boot:spring-boot-starter-actuator&quot;\n}</code></pre></div>\n<ul>\n<li>properties</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">management.endpoint.health.show-details=always</code></pre></div>\n<p><strong>Indicadores pré-configurados</strong></p>\n<p>Existem vários indicadores pré-configurados no spring aqui está <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#production-ready-health-indicators\">Lista Completa</a>.</p>\n<p><strong>Testando</strong></p>\n<ul>\n<li>inicia aplicação com:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ ./mvnw bootRun</code></pre></div>\n<ul>\n<li>Testa o seguinte end-point</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl --request GET --url http://localhost:8080/actuator/health</code></pre></div>\n<ul>\n<li>sua resposta será algo do tipo:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"UP\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>Customizando</strong></p>\n<p>Para customizar também e bem simples basta:</p>\n<ul>\n<li>Implementar a Interface <code class=\"language-text\">HealthIndicator</code> e retornar um objeto do tipo <code class=\"language-text\">Health</code> .</li>\n<li>Anota Classe com <code class=\"language-text\">@Component</code></li>\n</ul>\n<p>Exemplo:</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HealthCustomizedOfMyApplication</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">HealthIndicator</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Health</span> <span class=\"token function\">health</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">LocalDateTime</span><span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getMinute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token class-name\">Health</span><span class=\"token punctuation\">.</span><span class=\"token function\">down</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">withDetail</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Horário Errado\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Health</span><span class=\"token punctuation\">.</span><span class=\"token function\">up</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Com essa configuração retornaria uma resposta assim:</p>\n<ul>\n<li>Request:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl --request GET --url http://localhost:8080/actuator/health</code></pre></div>\n<ul>\n<li>Response:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"UP\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"healthCustomizedOfMyApplication\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"UP\"</span>\n   <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Health Check no Quarkus</h2>\n<p>O Quarkus segue a especificação <a href=\"https://github.com/eclipse/microprofile-health/\">eclipse/microprofile-health</a> e usa a implementação <a href=\"https://github.com/smallrye/smallrye-health/\">smallrye/smallrye-health</a> </p>\n<p><strong>Health</strong></p>\n<p>Segundo a especificação basicamente as informações de Health Check serão exibidas nos seguindes end-points:</p>\n<table>\n<thead>\n<tr>\n<th>end-point</th>\n<th>Descrição</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">/health/live</code></td>\n<td>A Aplicação está up e rodando</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">/health/ready</code></td>\n<td>Aplicação está pronta para receber requisições</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">/health</code></td>\n<td>Acumula todos os checks disponíveis.</td>\n</tr>\n</tbody>\n</table>\n<p>Para habilitarmos não precisa configurar nada no properties bastando apenas importar a seguinte dependência:</p>\n<ul>\n<li>POM.xml</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>io.quarkus<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>quarkus-smallrye-health<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><strong>Testando</strong></p>\n<ul>\n<li>inicia aplicação com:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ ./mvnw quarkus:dev</code></pre></div>\n<ul>\n<li>Testa o seguinte end-point</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl --request GET --url http://localhost:8080/health/live</code></pre></div>\n<ul>\n<li>sua resposta será algo do tipo:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"UP\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>Customizando</strong></p>\n<p>Para personalizar um <strong>Health Check</strong> e bem simples basta:</p>\n<ul>\n<li>Implementar a interface <code class=\"language-text\">HealthCheck</code> e retornar um objeto do tipo <code class=\"language-text\">HealthCheckResponse</code> .</li>\n<li>Anotar classe com <code class=\"language-text\">@ApplicationScoped</code> para deixar essa classe com escopo de aplicação.</li>\n<li>Anotar classe com qualifier <code class=\"language-text\">@Liveness</code> para informar que essa classe será usada dentro da estrutura de <strong>Health</strong>.</li>\n</ul>\n<p>Exemplo:</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Liveness</span>\n<span class=\"token annotation punctuation\">@ApplicationScoped</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HealthCustomizedOfMyApplication</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">HealthCheck</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">HealthCheckResponse</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">LocalDateTime</span><span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getMinute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token class-name\">HealthCheckResponse</span><span class=\"token punctuation\">.</span><span class=\"token function\">down</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Horário Errado\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">HealthCheckResponse</span><span class=\"token punctuation\">.</span><span class=\"token function\">up</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HealthCustomizedOfMyApplication\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Com essa configuração retornaria uma resposta assim:</p>\n<ul>\n<li>Request</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl --request GET --url http://localhost:8080/health/live</code></pre></div>\n<ul>\n<li>Response</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"DOWN\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"checks\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Horário Errado\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"DOWN\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Projeto de exemplo</p>\n<p><a href=\"https://github.com/cassunde/spring_boot_quarkus/blob/master/health/readme.md\">cassunde/spring<em>boot</em>quarkus · GitHub</a></p>","frontmatter":{"layout":"post","title":"Quarkus & Spring Boot - Health Check API","path":"/quarkus-spring/healthcheck","category":"Java","tags":["Arquitetura","Design"],"description":"","date":"2020/05/30","image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAHbBuiP/8QAFxAAAwEAAAAAAAAAAAAAAAAAARESIv/aAAgBAQABBQLVCkGv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEQQf/aAAgBAQAGPwJmT//EABkQAAMBAQEAAAAAAAAAAAAAAAABESExQf/aAAgBAQABPyFehQ0b0zPWrD//2gAMAwEAAgADAAAAEIAv/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAEx4f/aAAgBAwEBPxDE2//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQADAQEBAAAAAAAAAAAAAAEAETFRIWH/2gAIAQEAAT8QCTEAe/ZQqmG9hNpoveT/2Q==","aspectRatio":3.2510822510822512,"src":"/static/a2cebac1466d4833c9f4257a784832ec/0f3a1/banner-main.jpg","srcSet":"/static/a2cebac1466d4833c9f4257a784832ec/1ada3/banner-main.jpg 125w,\n/static/a2cebac1466d4833c9f4257a784832ec/8f7df/banner-main.jpg 250w,\n/static/a2cebac1466d4833c9f4257a784832ec/0f3a1/banner-main.jpg 500w,\n/static/a2cebac1466d4833c9f4257a784832ec/f9913/banner-main.jpg 750w,\n/static/a2cebac1466d4833c9f4257a784832ec/e2709/banner-main.jpg 751w","sizes":"(max-width: 500px) 100vw, 500px"}}}}}},{"post":{"html":"<h2>Publicando API-BIZU no Heroku</h2>\n<p>Hoje vou anotar como publiquei uma aplicação quarkus no heroku, nesse exemplo vou\ngerar uma imagem com a aplicação dentro e publica-la.</p>\n<!--more-->\n<p><strong>Heroku</strong></p>\n<p>Devemos criar uma conta heroku e instalar a CLI segindo esse tutorial:</p>\n<p><a href=\"https://devcenter.heroku.com/articles/heroku-cli\">https://devcenter.heroku.com/articles/heroku-cli</a></p>\n<p><strong>Criando imagem da Aplicação</strong></p>\n<p>Quando criamos um projeto quarkus vem com uma pasta chamada <code class=\"language-text\">docker</code> dentro de <code class=\"language-text\">src/main/</code>nessa pasta existe alguns Dokerfiles vamos usar o <code class=\"language-text\">Dockerfile.jvm</code> pois, usaremos o *-runner.jar para iniciar a aplicação.</p>\n<p>Para publicar uma imagem no heroku precisamo disponibilizar uma variável <code class=\"language-text\">--env PORT=</code> para que o Heroku possa fazer as rotas de rede até chegar na aplicação.</p>\n<p>Para disponibilizar essa porta vamos alterar o <code class=\"language-text\">Dockerfile.jvm</code> para como no exemplo abaixo:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">FROM registry.access.redhat.com/ubi8/ubi-minimal:8.1\n\nARG JAVA_PACKAGE=java-1.8.0-openjdk-headless\nARG RUN_JAVA_VERSION=1.3.5\n\nENV LANG=&#39;en_US.UTF-8&#39; LANGUAGE=&#39;en_US:en&#39;\n\n# Install java and the run-java script\n# Also set up permissions for user `1001`\nRUN microdnf install openssl curl ca-certificates ${JAVA_PACKAGE} \\\n    &amp;&amp; microdnf update \\\n    &amp;&amp; microdnf clean all \\\n    &amp;&amp; mkdir /deployments \\\n    &amp;&amp; chown 1001 /deployments \\\n    &amp;&amp; chmod &quot;g+rwX&quot; /deployments \\\n    &amp;&amp; chown 1001:root /deployments \\\n    &amp;&amp; curl https://repo1.maven.org/maven2/io/fabric8/run-java-sh/${RUN_JAVA_VERSION}/run-java-sh-${RUN_JAVA_VERSION}-sh.sh -o /deployments/run-java.sh \\\n    &amp;&amp; chown 1001 /deployments/run-java.sh \\\n    &amp;&amp; chmod 540 /deployments/run-java.sh \\\n    &amp;&amp; echo &quot;securerandom.source=file:/dev/urandom&quot; &gt;&gt; /etc/alternatives/jre/lib/security/java.security\n\n# Configure the JAVA_OPTIONS, you can add -XshowSettings:vm to also display the heap size.\nENV JAVA_OPTIONS=&quot;-Dquarkus.http.host=0.0.0.0 -Djava.util.logging.manager=org.jboss.logmanager.LogManager&quot;\n\nCOPY target/lib/* /deployments/lib/\nCOPY target/*-runner.jar /deployments/app.jar\n\nUSER 1001\n\nCMD [&quot;java&quot;, &quot;-Dquarkus.http.port=${PORT}&quot;, &quot;-Dquarkus.http.host=0.0.0.0&quot;, &quot;-jar&quot;, &quot;/deployments/app.jar&quot;]</code></pre></div>\n<p>Beleza, feito essas alteração vamos efetivamente criar a imagem, com o terminal na pasta raiz do projeto execute os seguintes comando:</p>\n<ul>\n<li>Empacote aplicação</li>\n</ul>\n<blockquote>\n<p>./mvnw package</p>\n</blockquote>\n<ul>\n<li>Build da imagem</li>\n</ul>\n<blockquote>\n<p>$ docker build -f src/main/docker/Dockerfile.jvm -t taok/api-bizu .</p>\n</blockquote>\n<ul>\n<li>Testando para ver se a porta está alterando quando criamos um container</li>\n</ul>\n<blockquote>\n<p>$ docker run -i —rm —name api-bizu —env PORT=8081 -p 8081:8081 taok/api-bizu</p>\n</blockquote>\n<ul>\n<li>Acessando heroku</li>\n</ul>\n<blockquote>\n<p>$ heroku login</p>\n</blockquote>\n<ul>\n<li>Criando app</li>\n</ul>\n<blockquote>\n<p>$ heroku create api-bizu</p>\n</blockquote>\n<ul>\n<li>Logando no Register do Heroku, para funcionar direito seu usuário deve ter permissão para adiministrar o docker.</li>\n</ul>\n<blockquote>\n<p>$ heroku container:login</p>\n</blockquote>\n<ul>\n<li>Registrando e subindo imagem</li>\n</ul>\n<blockquote>\n<p>$ docker tag taok/api-bizu registry.heroku.com/api-bizu/web</p>\n<p>$ docker push registry.heroku.com/api-bizu/web</p>\n</blockquote>\n<ul>\n<li>Publicando imagem</li>\n</ul>\n<blockquote>\n<p>$ heroku container:release web -a api-bizu</p>\n</blockquote>\n<ul>\n<li>Logando aplicação</li>\n</ul>\n<blockquote>\n<p>$ heroku logs —tail</p>\n</blockquote>\n<ul>\n<li>Para testar se a aplicação está de fato sendo executada</li>\n</ul>\n<blockquote>\n<p>$ curl <a href=\"https://api-bizu.herokuapp.com/coleta/candidaturas\">https://api-bizu.herokuapp.com/coleta/candidaturas</a></p>\n</blockquote>\n<p>Esses foram os passos que fiz para publicar uma imagem quarkus na Plataforma do Heroku</p>","frontmatter":{"layout":"post","title":"Publicando API-BIZU no Heroku","path":"/open-source/ta-ok/api-bizu","category":"Java","tags":["Arquitetura","Quarkus","OpenSource"],"description":"","date":"2020/04/23","image":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABkUlEQVQY02PIT56VnTgtM2FKevzk1NiJOUnTC1Pn5CfNKsucl3nsk++F/0Fn/wWc+w9CZ/8HnvsfeB6BGApSZucmzUiLm5gaOyEpui8xugdoVl7K3LKkGfkb7vpc/h949l/QBZDSkEsgEmoQGIE0A1F24nSgzoTonpjwzsiwtty0mUWxU8vmnQ64+T/o3D+zTS/VFt232vHB49gvoEHomgtTZmcmTI0J70hN7C/Kn1laPLsie35F+cqck18s93xm6bzM0ntLYNpd483vfU//g9sP1QxERalzgI5PSeid2Lu+v29dRdGC4oQZZftfmu77Ybfiifzil+qr35hu/WS16wtcP0IzGM3JTJxcWT63uWlpY/XysrS5mfvf+F7673/0u/HGdyZbP5nv+Gy166vDge9+Z/5hap4NDOqaosXluQsK0ueWxk8tWn7V7xownP+5Hf0F1Gm9+6vdvu+OB74Duf5n/6FrBqK8pFnAqCoARljMlIrJh0Kv/vc/8y/o/H+P47/tgToP/nA98tv92G/vU38Bx0gUlSxCS/kAAAAASUVORK5CYII=","aspectRatio":2.5,"src":"/static/0aaab77da35a432f23915d15479a2197/46604/heroku_docker.png","srcSet":"/static/0aaab77da35a432f23915d15479a2197/62d80/heroku_docker.png 125w,\n/static/0aaab77da35a432f23915d15479a2197/e1953/heroku_docker.png 250w,\n/static/0aaab77da35a432f23915d15479a2197/46604/heroku_docker.png 500w,\n/static/0aaab77da35a432f23915d15479a2197/d8815/heroku_docker.png 750w,\n/static/0aaab77da35a432f23915d15479a2197/31987/heroku_docker.png 1000w,\n/static/0aaab77da35a432f23915d15479a2197/eeb1b/heroku_docker.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}}}},{"post":{"html":"<h2>Tolerância a falhas</h2>\n<p>Esse tema e essencial para sistemas distribuios, pois serviços falharam, o seu ou do seu parceiro e por isso seu serviço deve está preparado para tal.</p>\n<blockquote>\n<p>Um microserviço pronto para produção é tolerante a falhas e preparado para catástrofes. </p>\n</blockquote>\n<h2>Circuit Breaker</h2>\n<blockquote>\n<p>Esse e um Design Pattern que ajudará seu serviço a lidar com a indisponibilidade ou alta latência dos seus serviços parceiros.</p>\n</blockquote>\n<p>O Padrão e bem simples, vem com o intuito de proteger o sistema contra falhas, ele deve monitorar e quando essas ocorrerem durante x tempo ou x vezes alguma ação deve ser executada.</p>\n<!--more-->\n<p>Imagine que um serviço que seu projeto usa fique fora do ar, se sem esse serviço seu projeto também parará então existe uma grande possibilidade de que esse serviço deva está dentro do seu projeto, caso não, temos que achar uma maneira de vivermos mesmo que momentaneamente sem esse serviço parceiro.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; margin-bottom: 1.0725rem; max-width: 750px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 77.33887733887734%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAABiUlEQVQoz4WS626CQBCFef9X6o829hU0VLSRUhWDgLALC8u1n6yuJho7CWRm55ydMzPrnE4nrbuiKJUqx3EchoF/3/dlqaqqqesGZxh6mxJCVCSaRmvtSJkL4SuVKFXfkYco+pXyh1Qcb6ezSyqOD/P523o9Wyw+IGfL5exw+Na6tQgsCL4879N134PANScmledZmm6FCLMsdNI0bVtEVmV5k911HWq7bmias0MX49W0bpSqpCwp5oDOsgxmN1mSJFJK0G3bci8pq8UaMKUUjsMnJyNmEvv9/ng8VpNBLopifDDIZC9kaMSPIIozWyozW1MAgYiCmef5hWw026lYnZCnRWqgQRAgKo5jQnrB+adyXde73Y6yACD7vs8tkJFg2rn0zBF6uqtRkxAyaIQY/RC4yJyb1ZzJURQB4r9arTabDdVw0AbaTPXVtK1su0/jWNArspiMmFKUZVWoIsSho/tn97wyXZkEj8SswZw/3TPgG5lu6TAMQ8/zmCqO67osQ032SKYpJofzB4QLZPkssi1dAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Diagrama Circuit Breaker\" title=\"Diagrama Circuit Breaker\" src=\"/static/1efb97254c11b0101db80d550eefa29b/1d69c/circuit-breaker-digram.png\" srcset=\"/static/1efb97254c11b0101db80d550eefa29b/4dcb9/circuit-breaker-digram.png 188w,\n/static/1efb97254c11b0101db80d550eefa29b/5ff7e/circuit-breaker-digram.png 375w,\n/static/1efb97254c11b0101db80d550eefa29b/1d69c/circuit-breaker-digram.png 750w,\n/static/1efb97254c11b0101db80d550eefa29b/fbf08/circuit-breaker-digram.png 962w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<h2>Exemplo</h2>\n<p>Nesse exemplo será implementado a mesma regra usando 2 framworks java diferentes:</p>\n<ul>\n<li>Spring-Boot</li>\n<li>Quarkus</li>\n</ul>\n<h3>Regra</h3>\n<p>Será criado um serviço que disponibiliza CEP apartir de uma requisição passando um número, vamos chamar essa aplicação de <code class=\"language-text\">nosso-cep</code> essa aplicação usará um outra onde efetivamente iremos consultar o CEP requisitado, essa aplicação se chamará <code class=\"language-text\">postmon</code>.</p>\n<p>Sempre que a aplicação <code class=\"language-text\">nosso-cep</code> fizer uma requisição a <code class=\"language-text\">postmon</code> e for com sucesso, devemos salvar essa resposta no banco de dados para quando a mesma um dia falhar faremos uma consulta no nosso banco de dados e continuar entregando a informação para o nosso cliente.</p>\n<p><em>Diagrama da solução.</em></p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; margin-bottom: 1.0725rem; max-width: 651px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.88632872503841%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3rBQf//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAAMBAQAAAAAAAAAAAAAAAAABEDFB/9oACAEBAAE/IeCmoU//2gAMAwEAAgADAAAAELAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAQEBAAMAAAAAAAAAAAAAAQARITFBYf/aAAgBAQABPxBF6IYYRvufr20GB4jUv//Z&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Diagrama Circuit Breaker\" title=\"Diagrama Circuit Breaker\" src=\"/static/6198ce2bded64e10e288fdf06e7f6f6b/aeb8d/diagrama-exemplo.jpg\" srcset=\"/static/6198ce2bded64e10e288fdf06e7f6f6b/bc01b/diagrama-exemplo.jpg 188w,\n/static/6198ce2bded64e10e288fdf06e7f6f6b/bf173/diagrama-exemplo.jpg 375w,\n/static/6198ce2bded64e10e288fdf06e7f6f6b/aeb8d/diagrama-exemplo.jpg 651w\" sizes=\"(max-width: 651px) 100vw, 651px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>No repositório abaixo existe essa implementação.</p>\n<p>Repositório:\n<a href=\"https://github.com/cassunde/spring_boot_quarkus/tree/master/circuit_breaker\">https://github.com/cassunde/spring<em>boot</em>quarkus/tree/master/circuit_breaker</a></p>","frontmatter":{"layout":"post","title":"Design Pattern - Circuit Breaker","path":"/design-pattern/circuit-breaker","category":"Java","tags":["Arquitetura"],"description":"","date":"2020/04/16","image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAME/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgAB/9oADAMBAAIQAxAAAAGGksuCv//EABkQAAIDAQAAAAAAAAAAAAAAAAACAxETMv/aAAgBAQABBQJeY01LP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABkQAAEFAAAAAAAAAAAAAAAAAAEAEBFBgf/aAAgBAQAGPwLUZot//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERUSH/2gAIAQEAAT8hbKvNIqTBDltQ/9oADAMBAAIAAwAAABB/z//EABYRAQEBAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPxAcZ//EABYRAAMAAAAAAAAAAAAAAAAAAAEQMf/aAAgBAgEBPxAxf//EABkQAQADAQEAAAAAAAAAAAAAAAEAESExUf/aAAgBAQABPxB1Fg0G1cJJgq6OXrOuafZ//9k=","aspectRatio":4.201666666666667,"src":"/static/a9fd065bc7840907c79164fd3e919ecd/0f3a1/circuit-breaker.jpg","srcSet":"/static/a9fd065bc7840907c79164fd3e919ecd/1ada3/circuit-breaker.jpg 125w,\n/static/a9fd065bc7840907c79164fd3e919ecd/8f7df/circuit-breaker.jpg 250w,\n/static/a9fd065bc7840907c79164fd3e919ecd/0f3a1/circuit-breaker.jpg 500w,\n/static/a9fd065bc7840907c79164fd3e919ecd/f9913/circuit-breaker.jpg 750w,\n/static/a9fd065bc7840907c79164fd3e919ecd/a7715/circuit-breaker.jpg 1000w,\n/static/a9fd065bc7840907c79164fd3e919ecd/495f9/circuit-breaker.jpg 2521w","sizes":"(max-width: 500px) 100vw, 500px"}}}}}},{"post":{"html":"<p>Uma arquitetura de microservice exige um grande ecossistema funcionando em conjunto para que tenhamos a melhor experiência com esse tipo de arquitetura, aqui compartilho um repositório simples para testar cada requisito desse ecossistema.</p>\n<p>Todos os exemplos estarei usando Java com Spring Boot e Quarkus.</p>\n<p>Será desenvolvido exemplos para demonstrar:</p>\n<ul>\n<li>Circuit Breaker</li>\n<li>Mensageiria</li>\n<li>Gateway</li>\n<li>Logs</li>\n<li>Contract</li>\n<li>etc.</li>\n</ul>","frontmatter":{"layout":"post","title":"Quarkus & Spring Boot - Comparando a mesma Feature","path":"/quarkus-spring/index","category":"Java","tags":["Quarkus","Arquitetura"],"description":"","date":"2020/02/16","image":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAABYlAAAWJQFJUiTwAAABSUlEQVQY04VQvYuCYBzuX3Ot7YK2E9puECUUtz7kQPIjyqVwE6/B0wMXo+OCpMnA9lpuk8Q8rAhKw7z7ZXHcds/w8r4/3ufj9xTO53Oapsfj8TOH53mbzSaKIhh+/4fCdrt1HEdRlH6/PxgMDMOY2tPx+1jTtMnHZLFYBEEA/y6XSxzHp9PpRsuy7Ere7/emacqyrKqqKIrD4Yv+pvMijxM4QRDValWSpNFo5Lruq6aBDWSEsHdnyMnz/HOOdrvdarVomoYTw7CnHPV6HVRQFH1E0VKpVKvVBEGYzWZXMgRYLpe6rt+cOY5jWbbZbOI4TlFUo9EgSbJSqRSLRQRBHsrlmxYMD4dD4Xf7JEl83weh+XwOOWF/EGIYptPpgBzo9nq9brcLimBuWdadnOX4WyM8oRvocrfbfeWA2sIwhMt6vbZte7Vawbcf1hc3ddCrNPMAAAAASUVORK5CYII=","aspectRatio":2.8297362110311752,"src":"/static/1a1ff5acbd7f842eb1e8697b03a32ddd/46604/quarkus_springboot.png","srcSet":"/static/1a1ff5acbd7f842eb1e8697b03a32ddd/62d80/quarkus_springboot.png 125w,\n/static/1a1ff5acbd7f842eb1e8697b03a32ddd/e1953/quarkus_springboot.png 250w,\n/static/1a1ff5acbd7f842eb1e8697b03a32ddd/46604/quarkus_springboot.png 500w,\n/static/1a1ff5acbd7f842eb1e8697b03a32ddd/d8815/quarkus_springboot.png 750w,\n/static/1a1ff5acbd7f842eb1e8697b03a32ddd/31987/quarkus_springboot.png 1000w,\n/static/1a1ff5acbd7f842eb1e8697b03a32ddd/37092/quarkus_springboot.png 1180w","sizes":"(max-width: 500px) 100vw, 500px"}}}}}}]}},"pageContext":{}}}